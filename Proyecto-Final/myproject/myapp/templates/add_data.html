{% extends 'base.html' %}

{% block title %}Agregar {{ model_name|title }} - Mi Proyecto Django{% endblock %}

{% block header %}Agregar {{ model_name|title }}{% endblock %}

{% block content %}
    <form id="addForm" method="post" action="">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="button" onclick="showConfirmation()">Guardar</button>
    </form>

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    
    <script>
        function showConfirmation() {
            Swal.fire({
                title: '¿Estás seguro?',
                text: '¡Se añadirá {{ model_name }}!',
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Sí, guardar'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Cuando el usuario confirma, enviar el formulario de manera asincrónica
                    $.ajax({
                        url: $('#addForm').attr('action'),
                        type: $('#addForm').attr('method'),
                        data: $('#addForm').serialize(),
                        success: function(response) {
                            // Manejar la respuesta si es necesario
                            Swal.fire('¡Guardado!', 'El {{ model_name }} ha sido añadido.', 'success');
                        },
                        error: function(error) {
                            // Manejar el error si es necesario
                            Swal.fire('Error', 'Hubo un problema al guardar el {{ model_name }}.', 'error');
                        }
                    });
                }
            });
        }
    </script>
{% endblock %}
